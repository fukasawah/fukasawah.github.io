<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=https://fukasawah.github.io/css/theme.min.3a45c284f2b5de322d794236765c960eca4b10f53bd5c46ad1f2b399c55f444d33cc096b56a42de29c1cf862a903f4bf936b32398b7c6bb74a9e365b30292cb5.css integrity="sha512-OkXChPK13jIteUI2dlyWDspLEPU71cRq0fKzmcVfRE0zzAlrVqQt4pwc+GKpA/S/k2syOYt8a7dKnjZbMCkstQ=="><link rel=stylesheet type=text/css href=https://fukasawah.github.io/css/syntax.min.9d0044b0ce135aff3405271be2a17805c5ae03ec48f146191dc4b30923424c76fe7c6086323aa2cbf83affd41e11fef907f33b6cd685fe3645043bb79f63509a.css integrity="sha512-nQBEsM4TWv80BScb4qF4BcWuA+xI8UYZHcSzCSNCTHb+fGCGMjqiy/g6/9QeEf75B/M7bNaF/jZFBDu3n2NQmg=="><title>fukasawah.github.io | Hugoのmarkdown-render-hooksのメモ</title></head><body><header><p><a href=https://fukasawah.github.io/>fukasawah.github.io</a></p></header><main><article><header><h1>Hugoのmarkdown-render-hooksのメモ</h1></header><p>HugoはMarkdownをHTMLに変換してくれるが、このときのHookを提供してくれている</p><p><a href=https://gohugo.io/getting-started/configuration-markup#markdown-render-hooks>https://gohugo.io/getting-started/configuration-markup#markdown-render-hooks</a></p><p>例えばmarkdownでは画像を埋め込むことができるが、画像のサムネイルも作りつつそれに合ったHTMLを出したい、<code>loading="lazy"</code>をつけたい、といった場合、<code>layouts\_default\_markup\render-image.html</code>を用意することでできるようになる。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=p>{{</span> <span class=p>.</span><span class=nx>Destination</span> <span class=p>|</span> <span class=nx>safeURL</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span><span class=o>-</span> <span class=err>$</span><span class=nx>res</span> <span class=o>:=</span> <span class=p>.</span><span class=nx>Page</span><span class=p>.</span><span class=nx>Resources</span><span class=p>.</span><span class=nx>GetMatch</span> <span class=p>.</span><span class=nx>Destination</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl><span class=p>{{</span><span class=o>-</span> <span class=k>if</span> <span class=err>$</span><span class=nx>res</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span><span class=o>-</span> <span class=err>$</span><span class=nx>image</span> <span class=o>:=</span> <span class=err>$</span><span class=nx>res</span><span class=p>.</span><span class=nx>Fit</span> <span class=s>&#34;300x300 jpg q50&#34;</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span><span class=o>-</span> <span class=err>$</span><span class=nx>imageUrl</span> <span class=o>:=</span> <span class=err>$</span><span class=nx>image</span><span class=p>.</span><span class=nx>RelPermalink</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nx>figure</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nx>a</span> <span class=nx>href</span><span class=p>=</span><span class=s>&#34;{{ .Destination | safeURL }}&#34;</span> <span class=nx>target</span><span class=p>=</span><span class=s>&#34;_blank&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nx>img</span> <span class=nx>src</span><span class=p>=</span><span class=s>&#34;{{ $imageUrl | safeURL }}&#34;</span> <span class=p>{{</span> <span class=nx>with</span> <span class=p>.</span><span class=nx>Text</span><span class=p>}}</span> <span class=nx>alt</span><span class=p>=</span><span class=s>&#34;{{ . }}&#34;</span><span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span> <span class=p>{{</span> <span class=nx>with</span> <span class=p>.</span><span class=nx>Title</span><span class=p>}}</span> <span class=nx>title</span><span class=p>=</span><span class=s>&#34;{{ . }}&#34;</span><span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span> <span class=nx>loading</span><span class=p>=</span><span class=s>&#34;lazy&#34;</span><span class=o>/</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=o>/</span><span class=nx>a</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span><span class=o>-</span> <span class=nx>with</span> <span class=p>.</span><span class=nx>Text</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nx>figcaption</span><span class=p>&gt;{{</span> <span class=p>.</span> <span class=p>}}&lt;</span><span class=o>/</span><span class=nx>figcaption</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>{{</span><span class=o>-</span> <span class=nx>end</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=o>/</span><span class=nx>figure</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{{</span><span class=o>-</span> <span class=k>else</span> <span class=p>}}</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nx>img</span> <span class=nx>src</span><span class=p>=</span><span class=s>&#34;{{ .Destination | safeURL }}&#34;</span> <span class=p>{{</span> <span class=nx>with</span> <span class=p>.</span><span class=nx>Text</span><span class=p>}}</span> <span class=nx>alt</span><span class=p>=</span><span class=s>&#34;{{ . }}&#34;</span><span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span> <span class=p>{{</span> <span class=nx>with</span> <span class=p>.</span><span class=nx>Title</span><span class=p>}}</span> <span class=nx>title</span><span class=p>=</span><span class=s>&#34;{{ . }}&#34;</span><span class=p>{{</span> <span class=nx>end</span> <span class=p>}}</span> <span class=nx>loading</span><span class=p>=</span><span class=s>&#34;lazy&#34;</span><span class=o>/</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl><span class=p>{{</span><span class=o>-</span> <span class=nx>end</span><span class=p>}}</span>
</span></span></code></pre></div><p>（直リンク画像などはelseに該当するはずだが、あまり動作確認してない）</p><p>結果サンプル。markdown viewerでもみれていて、HTMLではfigureタグで囲まれているはず。</p><p><figure><a href=images/index/2021-04-22-06-01-22.png target=_blank onclick=showOverlay(event)><img src=/posts/2021/04/22/hugo-markdown-render-hooks/images/index/2021-04-22-06-01-22_hu13c7e3eabc1f076990944d10962ad5d6_4597_300x300_fit_q75_bgffffff_box_3.jpg alt=test loading=lazy></a><figcaption>test</figcaption></figure></p><p>hugoのshortcodeと同じ要領なので全く同じことはshortcodeでもできるのだが、shortcodeはmarkdown viewerと相性が悪いのでこういうカスタマイズができるのはうれしい。</p><footer><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://fukasawah.github.io/tags/hugo>#Hugo</a></span></p><p>Created at: 2021-04-22 08:35 +0900<br>Updated at: 2021-04-22 08:50 +0900 <a href=https://github.com/fukasawah/blog/commit/ffa6df18747ef6464ff18c68dbf603da56feab0e target=_blank rel=noopener>#ffa6df1</a></p><p><a href=https://fukasawah.github.io/posts/2021/12/05/use-git-hooks-to-replace-creation-date/><span title=Gitのクライアントフックを使いHugoの記事の作成日時を忘れずに置き換える>&lt; Next</span></a>
|
<a href=https://fukasawah.github.io/posts/><span title=Posts>Posts</span></a>
|
<a href=https://fukasawah.github.io/posts/2020/12/13/totp/><span title=ワンタイムパスワードのTOTPを少し調べた>Prev ></span></a></p></footer></article><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//fukasawah.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
<script src=https://fukasawah.github.io/js/theme-posts.min.526bf4c8dff80bed936c62a06f7bc8c02703fad621e3dd2ba243812d43c40b98397ff1951e5905c790b97c38633d42a0e35bf5314fdf9fcfbce31b18181b8ae3.js integrity="sha512-Umv0yN/4C+2TbGKgb3vIwCcD+tYh490rokOBLUPEC5g5f/GVHlkFx5C5fDhjPUKg41v1MU/fn8+84xsYGBuK4w==" defer></script></main><footer><p>&copy; 2022 <a href=https://fukasawah.github.io/>fukasawah</a></p></footer></body></html>