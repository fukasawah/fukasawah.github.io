<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=https://fukasawah.github.io/css/theme.min.95e92366236e3eeadc2635f8c1c7b97ec3640de0147fa10ee1d281d56d40ee1aeb2c76977676599f543a2a682fd96d8cb9633a4fc700e537e46f8ba9d58df9f2.css integrity="sha512-lekjZiNuPurcJjX4wce5fsNkDeAUf6EO4dKB1W1A7hrrLHaXdnZZn1Q6Kmgv2W2MuWM6T8cA5Tfkb4up1Y358g=="><link rel=stylesheet href=https://fukasawah.github.io/css/syntax.min.9d0044b0ce135aff3405271be2a17805c5ae03ec48f146191dc4b30923424c76fe7c6086323aa2cbf83affd41e11fef907f33b6cd685fe3645043bb79f63509a.css integrity="sha512-nQBEsM4TWv80BScb4qF4BcWuA+xI8UYZHcSzCSNCTHb+fGCGMjqiy/g6/9QeEf75B/M7bNaF/jZFBDu3n2NQmg==" media=print onload='this.media="all"'><noscript><link rel=stylesheet type=text/css href=https://fukasawah.github.io/css/syntax.min.9d0044b0ce135aff3405271be2a17805c5ae03ec48f146191dc4b30923424c76fe7c6086323aa2cbf83affd41e11fef907f33b6cd685fe3645043bb79f63509a.css integrity="sha512-nQBEsM4TWv80BScb4qF4BcWuA+xI8UYZHcSzCSNCTHb+fGCGMjqiy/g6/9QeEf75B/M7bNaF/jZFBDu3n2NQmg=="></noscript><title>HugoのThemeを書いてみた | fukasawah.github.io</title></head><body><header><p><a href=https://fukasawah.github.io/>fukasawah.github.io</a></p></header><main><article><header><h1>HugoのThemeを書いてみた</h1></header><aside class=toc><nav id=TableOfContents><ul><li><a href=#学んだこと>学んだこと</a><ul><li><a href=#テンプレートを作り始める>テンプレートを作り始める</a></li><li><a href=#動作が怪しいときはhugo-serverを再起動>動作が怪しいときはHugo serverを再起動</a></li><li><a href=#シンタックスハイライト>シンタックスハイライト</a></li><li><a href=#templateでどういう変数が使えるか悩んだ時>Templateでどういう変数が使えるか悩んだ時</a></li><li><a href=#taxonomy-terms-templates-でslugではなく名前を使いたい>Taxonomy Terms Templates でslugではなく名前を使いたい</a></li><li><a href=#ジェネレータで作られるrssフィードのテンプレートを書き直す>ジェネレータで作られるRSSフィードのテンプレートを書き直す</a></li><li><a href=#テンプレートにおける共通化>テンプレートにおける共通化</a></li><li><a href=#cssとjavascriptのminifyのpartial-template化>CSSとJavaScriptのMinifyのPartial Template化</a></li><li><a href=#cssのlight-modedark-mode>CSSのlight mode/dark mode</a></li><li><a href=#日本語が混在した行と英語だけの行で高さが変わる>日本語が混在した行と英語だけの行で高さが変わる</a></li><li><a href=#fontの選定>fontの選定</a></li><li><a href=#lighthouseの結果をみてみた>Lighthouseの結果をみてみた</a></li></ul></li></ul></nav></aside><p>Hugoのお勉強(3年振り)</p><p>今までは<a href=https://github.com/Track3/hermit>Hermit</a>というシンプルなテーマを使っていた。</p><p>その後、部分的にテーマをカスタマイズして使っていたが、<a href=https://justinjackson.ca/words.html>このページに感化されて</a> もっとシンプルなのが欲しいなと思った。</p><p>Hugoの勉強も兼ねて1から書いてみることにした。でも結局今までの振る舞いを残したかったり、細かいところにこだわり始めてしまい、シンプルじゃなくなったし、結構時間を掛けてしまった。でもおかげでだいぶ仕組みが理解できたと思う。</p><p>あと、目次を表示するか悩んだり、HTML構造上正しいのかよくわかってなかったり、アクセシビリティ的によいのかわかってなかったり、テーマを別リポジトリにしたりとかしておきたいが、一旦このまま。</p><p>以下は学んだ事とかをメモ。HugoとかHTML,CSSの事とか。</p><h2 id=学んだこと>学んだこと</h2><h3 id=テンプレートを作り始める>テンプレートを作り始める</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo new theme テンプレート名
</span></span></code></pre></div><p><code>themes/テンプレート名</code> の下に色々作られる。内容はしょぼかったり、そのままでは動かなかったりするので頑張る。</p><h3 id=動作が怪しいときはhugo-serverを再起動>動作が怪しいときはHugo serverを再起動</h3><p>テンプレートを追加したり色々やっていると、どう考えても反映されるはずの変更が反映されないことがある。
そんなときはまずプロセスを再起動しましょう。再起動のコストはさほど高くないので、うまく反映されないなと思ったらとりあえずやるがいいと思う。</p><p>これを頭に入れておかないと、ページもホットリロードされているのに全然反映されない事象にぶつかったときに頭を悩まし続ける事となる。
（再起動しても反映されない時のほうが多かったが、原因の切り分けのためだと思って前向きにとらえる）</p><h3 id=シンタックスハイライト>シンタックスハイライト</h3><p><a href=https://gohugo.io/content-management/syntax-highlighting/>https://gohugo.io/content-management/syntax-highlighting/</a></p><p>Hugoは Chroma によってコードブロックに対してシンタックスハイライト用のHTMLを生成してくれる。HTMLを作るだけなので、CSSを当ててあげないとうまくいかない。</p><p>シンタックスハイライト用のCSSは以下を参考に作る。</p><p><a href=https://gohugo.io/content-management/syntax-highlighting/#generate-syntax-highlighter-css>https://gohugo.io/content-management/syntax-highlighting/#generate-syntax-highlighter-css</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>hugo gen chromastyles --style<span class=o>=</span>monokai &gt; syntax.css
</span></span></code></pre></div><p>行番号が付かないので、行番号を付けたい時は以下のCSSを当てると良い感じにつくかもしれない。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>highlight</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>counter-reset</span><span class=p>:</span> <span class=n>lineno</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>.</span><span class=nc>line</span><span class=p>::</span><span class=nd>before</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>counter-increment</span><span class=p>:</span> <span class=n>lineno</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>display</span><span class=p>:</span> <span class=kc>inline-block</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>text-align</span><span class=p>:</span> <span class=kc>right</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>content</span><span class=p>:</span> <span class=nb>counter</span><span class=p>(</span><span class=n>lineno</span><span class=p>)</span> <span class=s2>&#34;: &#34;</span><span class=p>;</span> <span class=c>/* お好みで */</span>
</span></span><span class=line><span class=cl>    <span class=k>min-width</span><span class=p>:</span> <span class=mf>2.5</span><span class=kt>em</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* スクロールバーを付けたい場合 */</span>
</span></span><span class=line><span class=cl><span class=nt>pre</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>padding</span><span class=p>:</span> <span class=mf>0.5</span><span class=kt>em</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>max-height</span><span class=p>:</span> <span class=mi>20</span><span class=kt>em</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>overflow</span><span class=p>:</span> <span class=kc>auto</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=c>/* 適切な色は適当につける */</span>
</span></span><span class=line><span class=cl>    <span class=c>/* background-color: var(--code-background-color); */</span>
</span></span><span class=line><span class=cl>    <span class=c>/* color: var(--code-color); */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><figure><a href=images/index/2022-10-31-23-58-05.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-10-31-23-58-05_hu1b36e619819fa83704ea271b2964b972_59533_500x500_fit_q80_h2_box_3.webp width=500 height=341><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-10-31-23-58-05_hu1b36e619819fa83704ea271b2964b972_59533_500x500_fit_q80_bgffffff_box_3.jpg alt=動作イメージ width=500 height=341 loading=lazy></picture></a><figcaption>動作イメージ</figcaption></figure></p><h3 id=templateでどういう変数が使えるか悩んだ時>Templateでどういう変数が使えるか悩んだ時</h3><p>tl;dr: 型名を特定してAPI Docsを引きましょう</p><p>Hugoはコンテキストが存在しており、このコンテキストのときどういう変数が使えるんだっけ？と悩む時があった。</p><p>Template上はトライアンドエラーはしやすいとはいえ、使える変数をノーヒントで当てるのは非常に難しい。</p><p>そんなとき次を見つけた。</p><p><a href=https://gohugo.io/templates/template-debugging/>https://gohugo.io/templates/template-debugging/</a></p><p>つまり、 <code>{{ printf "%#v" . }}</code> を適当に埋め込んで画面で見るとか、わざと存在しない <code>{{ .FOOOO }}</code> などとしてビルドでエラーを起こせば型名が分かる。</p><p>（ただ、<code>{{ .FOOOO }}</code> と絶対存在しないはずなのにビルドが通る時がある。これは正直よくわかってない。mapとかだから？）</p><p>そんなこんなで型名がだいたい分かったらAPI Docsから型名を調べてメソッドを探るのがよさそう。</p><p><a href=https://pkg.go.dev/github.com/gohugoio/hugo#section-directories>https://pkg.go.dev/github.com/gohugoio/hugo#section-directories</a></p><p>なお、 <code>.</code>(ドット)は現在のコンテキストを指す。以下のドキュメントで解説されている。</p><p><a href=https://gohugo.io/templates/introduction/#the-dot>https://gohugo.io/templates/introduction/#the-dot</a></p><h3 id=taxonomy-terms-templates-でslugではなく名前を使いたい>Taxonomy Terms Templates でslugではなく名前を使いたい</h3><p>どうググればいいかわからなくて結構悩んだが、以下を見ればできるはず</p><ul><li><a href=https://gohugo.io/templates/taxonomy-templates/#taxonomy-terms-templates>https://gohugo.io/templates/taxonomy-templates/#taxonomy-terms-templates</a></li><li><a href=https://github.com/gohugoio/hugo/issues/5719>https://github.com/gohugoio/hugo/issues/5719</a></li></ul><p>例えば、「タグ」の「一覧」のページを作りたいとする。このタグ一覧ページにはタグ名とタグのリンクと件数を一覧で出したい。</p><p>config.tomlは以下にする。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-config.toml data-lang=config.toml><span class=line><span class=cl><span class=c># なお、tagはデフォルトのtaxonomyなので定義する必要はない。</span>
</span></span><span class=line><span class=cl><span class=c># https://gohugo.io/content-management/taxonomies/#default-taxonomies</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>[</span><span class=nx>taxonomies</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=nx>tag</span> <span class=p>=</span> <span class=s2>&#34;tags&#34;</span>
</span></span></code></pre></div><p>すると <code>layouts/tags/terms.html</code> ファイルを用意することで、tags特有のtaxonomy terms templatesが適用することができる。</p><p>例えば、taxonomy(例えばtags)が持つterm(項目)を列挙するページを作りたい場合はこうする。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-layout/tags/terms.html data-lang=layout/tags/terms.html><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {{ range .Data.Terms.ByCount }}
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>a</span> <span class=na>href</span><span class=o>=</span><span class=s>&#34;{{ .Page.Permalink }}/&#34;</span><span class=p>&gt;</span>{{ .Page.Title }}<span class=p>&lt;/</span><span class=nt>a</span><span class=p>&gt;</span> ({{ .Count }})
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>li</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        {{ end }}
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>ul</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><code>.Data.Terms.ByCount</code> で得られるのは <code>hugolib.OrderedTaxonomyEntry</code> であり、これは <code>WeightedPages</code> が埋め込まれた型(Embedding)なので、<code>Page()</code>を呼ぶことができる、という仕組みらしい。</p><p>このあたり、ソースコードだけだと結構辛いので、API Docsを読むと分かりやすい。</p><p><a href=https://pkg.go.dev/github.com/gohugoio/hugo@v0.105.0/resources/page#WeightedPages>https://pkg.go.dev/github.com/gohugoio/hugo@v0.105.0/resources/page#WeightedPages</a></p><p>なぜ<code>.Name</code>があるのに<code>.Page.Title</code>を使うのかというと、<code>.Name</code>はなぜかSlugになっているため、ちょっと見た目が悪い。
例えば <code>Application Insights</code>とかは<code>application-insights</code>いう形(slug)になってしまう。URLであれば良いが表示は元のままにしたいだろう。</p><h3 id=ジェネレータで作られるrssフィードのテンプレートを書き直す>ジェネレータで作られるRSSフィードのテンプレートを書き直す</h3><p>ジェネレータで作られるRSSフィードのテンプレートがちょっと古いし、Content要素など無駄にサイズが大きい割に仕様にない要素があった。</p><p>パッと見た感じ、組み込みのテンプレートがさほど悪くなさそうなので使ってもよいかもしれない。ジェネレータが作ったRSSのテンプレートファイルを削除して未指定の状態にすると、組み込みのほうが使われる。</p><p><a href=https://gohugo.io/templates/rss/#the-embedded-rssxml>https://gohugo.io/templates/rss/#the-embedded-rssxml</a></p><p>なお、今回タグ用と投稿用のRSSの内容をわずかに変えたかったので、別々に生成するようにしている。（RSSを色々用意するほどの記事は書いてないですけど）</p><h3 id=テンプレートにおける共通化>テンプレートにおける共通化</h3><p>shortcodeはコンテンツ(markdown)でしか使えず、テンプレートには使えないようだった。</p><p>テンプレートではpartial templateを使うしかなさそう。これは引数に制約があり、<a href=https://discourse.gohugo.io/t/how-to-pass-variables-to-a-partial-template/7321>dictを使ったハックをしないといけない</a>。使った例は後述。</p><h3 id=cssとjavascriptのminifyのpartial-template化>CSSとJavaScriptのMinifyのPartial Template化</h3><p><a href=https://gohugo.io/hugo-pipes/introduction/>https://gohugo.io/hugo-pipes/introduction/</a></p><p>Hugo Pipesにより、Minifyを行ったり、Fingerprintを計算したり、Cache bustingができるURLも用意してくれる。開発中もCSSがキャッシュされてやりづらかったのが解消できる。</p><p>resource.Get, resources.Matchで見つけられるのは <code>/assets</code>, <code>/themes/テーマ名/assets/</code> にあるものだけ。（<code>assets</code>は設定の<code>assetDir</code>で変えられるっぽい）
最初、<code>static</code>とかにあるファイルもみてくれると思ったがそんなことなかった。</p><p><code>assets/js/app.js</code>というJavaScriptのMinifyをするだけなら以下のようにテンプレートを書く。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{{- $js := resources.Get &#34;js/app.js&#34; | resources.Minify | resources.Fingerprint &#34;sha512&#34; -}}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ $js.Permalink }}&#34;</span> <span class=na>integrity</span><span class=o>=</span><span class=s>&#34;{{ $js.Data.Integrity }}&#34;</span> <span class=na>defer</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><p>resources.Getで参照するときは<code>assets/</code>は不要。それは上記の理由。</p><p>これでうまくMinifyされFingerprint計算を使いintegrity属性を設定したscriptタグを埋め込むことができる。</p><p>ただ、開発時はminifyされると分かりにくい。厄介なことに、<code>hugo --minify</code> としなくても上記のテンプレートを使うと適用されてしまう。</p><p>なので開発時はminify化したくない。また2つ以上のタグを埋め込もうとすると冗長になってしまう。それをPartial Templateで書いてみる。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-layouts/partials/minify-js.html data-lang=layouts/partials/minify-js.html><span class=line><span class=cl>{{- $js := resources.Get .src | resources.Minify | resources.Fingerprint &#34;sha512&#34; -}}
</span></span><span class=line><span class=cl>{{- if not hugo.IsProduction -}}
</span></span><span class=line><span class=cl>  {{- $js = resources.Get .src | resources.Fingerprint &#34;sha512&#34; -}}
</span></span><span class=line><span class=cl>{{- end -}}
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>script</span> <span class=na>src</span><span class=o>=</span><span class=s>&#34;{{ $js.Permalink }}&#34;</span> <span class=na>integrity</span><span class=o>=</span><span class=s>&#34;{{ $js.Data.Integrity }}&#34;</span> <span class=na>defer</span><span class=p>&gt;&lt;/</span><span class=nt>script</span><span class=p>&gt;</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-layouts/posts/single.html data-lang=layouts/posts/single.html><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 埋め込む所に以下を書く --&gt;</span>
</span></span><span class=line><span class=cl>    {{ partial &#34;minify-js.html&#34; (dict &#34;src&#34; &#34;js/theme-posts.js&#34;) }}
</span></span><span class=line><span class=cl>...
</span></span></code></pre></div><p>CSSも要領は同じである。（SCSSをCSSにしたいとか、SourceMapを書き出したい、とかあるかもしれないが、必要ないと思ったので今回はそこまでやらない。よくわからないというのもある。）</p><h3 id=cssのlight-modedark-mode>CSSのlight mode/dark mode</h3><p>最近のOSはダークモードをサポートしており、ブラウザも追従している。</p><p>mediaクエリの<code>(prefers-color-scheme: dark)</code>でダークモードを区別できる。</p><p>そこでこんな感じで色替えしてみた。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=c>/* not dark theme */</span>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>media</span> <span class=o>(</span><span class=nt>not</span> <span class=o>(</span><span class=nt>prefers-color-scheme</span><span class=o>:</span> <span class=nt>dark</span><span class=o>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>--background-color</span><span class=p>:</span> <span class=mh>#EEE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--font-color</span><span class=p>:</span> <span class=mh>#333</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--link-color</span><span class=p>:</span> <span class=mh>#00F</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--link-active-color</span><span class=p>:</span> <span class=mh>#99F</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--code-background-color</span><span class=p>:</span> <span class=mh>#EEE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--code-color</span><span class=p>:</span> <span class=mh>#333</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--border-color</span><span class=p>:</span> <span class=mh>#333</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c>/* dark theme */</span>
</span></span><span class=line><span class=cl><span class=p>@</span><span class=k>media</span> <span class=o>(</span><span class=nt>prefers-color-scheme</span><span class=o>:</span> <span class=nt>dark</span><span class=o>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>:</span><span class=nd>root</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=nv>--background-color</span><span class=p>:</span> <span class=mh>#333</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--font-color</span><span class=p>:</span> <span class=mh>#CCC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--link-color</span><span class=p>:</span> <span class=mh>#99F</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--link-active-color</span><span class=p>:</span> <span class=mh>#CCF</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--code-background-color</span><span class=p>:</span> <span class=mh>#272822</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--code-color</span><span class=p>:</span> <span class=mh>#f8f8f2</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=nv>--border-color</span><span class=p>:</span> <span class=mh>#CCC</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>モードを切り替えるとこんな感じに色が変わる</p><table><thead><tr><th></th><th></th></tr></thead><tbody><tr><td><figure><a href=images/index/2022-11-01-00-21-34.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-21-34_hu0f4c4000fa4123decec5a0aa2c4dc22e_17297_500x500_fit_q80_h2_box_3.webp width=500 height=283><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-21-34_hu0f4c4000fa4123decec5a0aa2c4dc22e_17297_500x500_fit_q80_bgffffff_box_3.jpg alt=dark width=500 height=283 loading=lazy></picture></a><figcaption>dark</figcaption></figure></td><td><figure><a href=images/index/2022-11-01-00-21-53.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-21-53_hu055c5070472c7e86cb439c17883c3556_16810_500x500_fit_q80_h2_box_3.webp width=500 height=303><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-21-53_hu055c5070472c7e86cb439c17883c3556_16810_500x500_fit_q80_bgffffff_box_3.jpg alt=light width=500 height=303 loading=lazy></picture></a><figcaption>light</figcaption></figure></td></tr></tbody></table><p>動作検証したい場合、Firefoxは開発者ツールで切り替えができる。</p><p><figure><a href=images/index/2022-10-31-23-56-56.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-10-31-23-56-56_hu92a4782cd1a72028b014cca165514bd2_53113_500x500_fit_q80_h2_box_3.webp width=500 height=142><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-10-31-23-56-56_hu92a4782cd1a72028b014cca165514bd2_53113_500x500_fit_q80_bgffffff_box_3.jpg alt=Firefoxの切り替え設定 width=500 height=142 loading=lazy></picture></a><figcaption>Firefoxの切り替え設定</figcaption></figure></p><p>Chrome(Windows)はRenderingのオプションから設定することで切り替えができる。</p><p><figure><a href=images/index/2022-11-01-00-16-38.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-16-38_hubb9c4bc2e5bd64e5d1a002f1396b3e4e_17102_500x500_fit_q80_h2_box_3.webp width=500 height=194><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-16-38_hubb9c4bc2e5bd64e5d1a002f1396b3e4e_17102_500x500_fit_q80_bgffffff_box_3.jpg alt=Chromeの切り替え設定 width=500 height=194 loading=lazy></picture></a><figcaption>Chromeの切り替え設定</figcaption></figure></p><p>Safari(iOS)だとiPhone上からでは簡単にはできず、OSの設定で切り替えることはできた。</p><p>なお、シンタックスハイライトも同じ要領で2つ用意して切り替えている。
そんなわけで、取り入れてみたものの、まぁなくても良かったかなぁ、と思ったりした。</p><h3 id=日本語が混在した行と英語だけの行で高さが変わる>日本語が混在した行と英語だけの行で高さが変わる</h3><p><strong>tl;dr: line-heightを明示する。</strong></p><p>日本語と英語が混在した行があると、高さが変わってしまう時がある。</p><p>以下は該当行の行間が異なる箇所があるのと、日本語でフォントサイズが変わっている例（Firefoxだと選択範囲で反転すると分かりやすい。Chromeはこうは見えない）</p><p><figure><a href=images/index/2022-11-01-07-08-01.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-07-08-01_hu03589a3493d8482d64cd79c4fa7fcbe3_15779_500x500_fit_q80_h2_box_3.webp width=500 height=210><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-07-08-01_hu03589a3493d8482d64cd79c4fa7fcbe3_15779_500x500_fit_q80_bgffffff_box_3.jpg alt=日本語がある行だけ行間が広めになる width=500 height=210 loading=lazy></picture></a><figcaption>日本語がある行だけ行間が広めになる</figcaption></figure></p><p>これについては、厳密にはline-heightを明示すればよいようだった。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-css data-lang=css><span class=line><span class=cl><span class=nt>html</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>font-size</span><span class=p>:</span> <span class=mi>16</span><span class=kt>px</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>line-height</span><span class=p>:</span> <span class=mf>1.25</span><span class=p>;</span> <span class=c>/* 追加 */</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p><figure><a href=images/index/2022-11-01-07-05-27.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-07-05-27_huc4e135349756596bf3b2616c7aad3ade_13904_500x500_fit_q80_h2_box_3.webp width=500 height=197><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-07-05-27_huc4e135349756596bf3b2616c7aad3ade_13904_500x500_fit_q80_bgffffff_box_3.jpg alt=line-height明示で行間が一定になる width=500 height=197 loading=lazy></picture></a><figcaption>line-height明示で行間が一定になる</figcaption></figure></p><p>なお、1.25としているが1.5でも1.0でもよい。とにかく高さがfont-sizeに対して一定であることを明示させるのが大事らしい。
また、<code>html</code>要素に適用しているが、上記のように<code>code</code>内だけに適用したいなら<code>code</code>要素だけでもよい。</p><h3 id=fontの選定>fontの選定</h3><p>見栄えが変だな、と思ったら英単語と日本語でフォントが違うことに気づいた。</p><p>という事で以下にした。</p><ul><li>日本語・英語<ul><li>&ldquo;游ゴシック&rdquo;, &ldquo;游ゴシック体&rdquo;, &ldquo;Yu Gothic&rdquo;, YuGothic</li><li>&ldquo;メイリオ&rdquo;</li></ul></li><li>ソースコード<ul><li>consolas</li></ul></li></ul><p>游ゴシックはWindows,Macで微妙に名前が違うらしいので注意。</p><p>consolasは日本語に対応していないらしい。気にならないので今はそのままにする。</p><h3 id=lighthouseの結果をみてみた>Lighthouseの結果をみてみた</h3><p>改善の余地ありですね。</p><p><figure><a href=images/index/2022-11-01-00-29-20.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-29-20_hubfaf37d1e225d22a2ee4df3ac86a74fd_21846_500x500_fit_q80_h2_box_3.webp width=500 height=138><img src=/posts/2022/11/01/create-hugo-theme/images/index/2022-11-01-00-29-20_hubfaf37d1e225d22a2ee4df3ac86a74fd_21846_500x500_fit_q80_bgffffff_box_3.jpg alt=Lighthouseの結果 width=500 height=138 loading=lazy></picture></a><figcaption>Lighthouseの結果</figcaption></figure></p><footer><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://fukasawah.github.io/tags/hugo>#Hugo</a></span></p><p>Created at: 2022-11-01 00:31 +0900<br>Updated at: 2022-11-01 07:39 +0900 <a href=https://github.com/fukasawah/blog/commit/3d130c469b52ed72dec4133260d99a10d135e6e6 target=_blank rel=noopener>#3d130c4</a></p><p><a href=https://fukasawah.github.io/posts/2022/11/08/azure-function-core-tools-run-start-error/><span title="Azure Functions Core Tools(v4.0.4829)でfunc start時にSystem.Net.Http.Formatting.dllが無いエラーが発生したときの対処">&lt; Next</span></a>
|
<a href=https://fukasawah.github.io/posts/><span title=Posts>Posts</span></a>
|
<a href=https://fukasawah.github.io/posts/2022/09/19/exam-az-204/><span title=MCP資格のAZ-204に合格しました>Prev ></span></a></p></footer></article><script src=https://fukasawah.github.io/js/theme-posts.min.526bf4c8dff80bed936c62a06f7bc8c02703fad621e3dd2ba243812d43c40b98397ff1951e5905c790b97c38633d42a0e35bf5314fdf9fcfbce31b18181b8ae3.js integrity="sha512-Umv0yN/4C+2TbGKgb3vIwCcD+tYh490rokOBLUPEC5g5f/GVHlkFx5C5fDhjPUKg41v1MU/fn8+84xsYGBuK4w==" defer></script></main><footer><p>&copy; 2024 <a href=https://fukasawah.github.io/>fukasawah</a></p></footer></body></html>