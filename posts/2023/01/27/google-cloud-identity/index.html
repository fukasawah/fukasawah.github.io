<!doctype html><html lang=ja><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet type=text/css href=https://fukasawah.github.io/css/theme.min.c2192e42f5d8aa9c5c065b0031ed7adc9d457a6b5fa3af342c2e576cdee33bce3ae51be85f1c2356f2270efcea7d867a97195c67f6061e7036c402f41d576f97.css integrity="sha512-whkuQvXYqpxcBlsAMe163J1Femtfo680LC5XbN7jO8465RvoXxwjVvInDvzqfYZ6lxlcZ/YGHnA2xAL0HVdvlw=="><link rel=stylesheet href=https://fukasawah.github.io/css/syntax.min.9d0044b0ce135aff3405271be2a17805c5ae03ec48f146191dc4b30923424c76fe7c6086323aa2cbf83affd41e11fef907f33b6cd685fe3645043bb79f63509a.css integrity="sha512-nQBEsM4TWv80BScb4qF4BcWuA+xI8UYZHcSzCSNCTHb+fGCGMjqiy/g6/9QeEf75B/M7bNaF/jZFBDu3n2NQmg==" media=print onload='this.media="all"'><noscript><link rel=stylesheet type=text/css href=https://fukasawah.github.io/css/syntax.min.9d0044b0ce135aff3405271be2a17805c5ae03ec48f146191dc4b30923424c76fe7c6086323aa2cbf83affd41e11fef907f33b6cd685fe3645043bb79f63509a.css integrity="sha512-nQBEsM4TWv80BScb4qF4BcWuA+xI8UYZHcSzCSNCTHb+fGCGMjqiy/g6/9QeEf75B/M7bNaF/jZFBDu3n2NQmg=="></noscript><title>Google Cloud Identityを始める | fukasawah.github.io</title></head><body><header><p><a href=https://fukasawah.github.io/>fukasawah.github.io</a></p></header><main><article><header><h1>Google Cloud Identityを始める</h1></header><aside class=toc><nav id=TableOfContents><ul><li><a href=#背景>背景</a></li><li><a href=#用意するもの>用意するもの</a></li><li><a href=#手順>手順</a><ul><li><a href=#1-cloud-identity-と組織>1. Cloud Identity と組織</a></li><li><a href=#試しにメンバーのアカウントでログイン>試しにメンバーのアカウントでログイン</a></li><li><a href=#管理者ユーザでログインする>管理者ユーザでログインする</a></li><li><a href=#２ユーザとグループ>２．ユーザとグループ</a></li><li><a href=#３管理者権限>３．管理者権限</a></li><li><a href=#４お支払い>４．お支払い</a></li><li><a href=#５リソース階層とアクセスの設定>５．リソース階層とアクセスの設定</a></li><li><a href=#６ネットワーキング>６．ネットワーキング</a></li><li><a href=#７ロギングの一元化>７．ロギングの一元化</a></li><li><a href=#８モニタリング>８．モニタリング</a></li><li><a href=#９セキュリティ>９．セキュリティ</a></li><li><a href=#１０サポート>１０．サポート</a></li></ul></li></ul></nav></aside><p>初GCPです。</p><h2 id=背景>背景</h2><p>Google Cloud(GCP)では何かと組織を作れ作れといわれる。</p><p>Google Cloud IdentityはGoogle Workspaceとは別らしい（ちょっとよくわかってない。Workspaceのほうが上位互換っぽい？）</p><p>Google Cloudにおいては組織なしでもやっていけるが、違いを見るためにまずは作ってみることにした。</p><h2 id=用意するもの>用意するもの</h2><ul><li>Google アカウント（Google Cloud Identityの組織を作るまでの繋ぎ。メールアドレスはなんでも）</li><li>ドメイン（DNS設定が行えるぐらいでよさそう）</li></ul><h2 id=手順>手順</h2><h3 id=1-cloud-identity-と組織>1. Cloud Identity と組織</h3><p>Cloud Identityアカウントを作る必要がある。</p><p>[https://console.cloud.google.com/cloud-setup/overview] にアクセス</p><p><figure><a href=images/index/2023-01-27-02-10-15.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-10-15_huac72d53dfb482c47e4907db33463e6b2_170447_500x500_fit_q80_h2_box_3.webp width=500 height=289><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-10-15_huac72d53dfb482c47e4907db33463e6b2_170447_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=289 loading=lazy></picture></a></figure></p><p>「設定を開始する」を押す。</p><p><figure><a href=images/index/2023-01-27-02-11-24.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-11-24_hufacdb6ebbc16711e33756747fa19e743_259612_500x500_fit_q80_h2_box_3.webp width=474 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-11-24_hufacdb6ebbc16711e33756747fa19e743_259612_500x500_fit_q80_bgffffff_box_3.jpg width=474 height=500 loading=lazy></picture></a></figure></p><ul><li>初めて利用する</li><li>Cloud Identityに申し込む</li></ul><p><figure><a href=images/index/2023-01-27-02-12-03.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-12-03_hu7533c286fdf389d52ecc6ea3eefe790e_39498_500x500_fit_q80_h2_box_3.webp width=336 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-12-03_hu7533c286fdf389d52ecc6ea3eefe790e_39498_500x500_fit_q80_bgffffff_box_3.jpg width=336 height=500 loading=lazy></picture></a></figure></p><p>別タブでしょっぱい画面が出る。</p><p><figure><a href=images/index/2023-01-27-02-12-50.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-12-50_hu4898f43544cd6feff9545fed71e58cac_49752_500x500_fit_q80_h2_box_3.webp width=500 height=484><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-12-50_hu4898f43544cd6feff9545fed71e58cac_49752_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=484 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-02-13-59.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-13-59_hu171181c635bf8d419fbcc96f25d7b2f8_65170_500x500_fit_q80_h2_box_3.webp width=500 height=394><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-13-59_hu171181c635bf8d419fbcc96f25d7b2f8_65170_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=394 loading=lazy></picture></a></figure></p><p>ドメインを指定。（メールを受け取れる必要はなさそう）</p><p><figure><a href=images/index/2023-01-27-02-14-48.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-14-48_hua585c133fc91e87b7b644cda7c93e757_45568_500x500_fit_q80_h2_box_3.webp width=500 height=274><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-14-48_hua585c133fc91e87b7b644cda7c93e757_45568_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=274 loading=lazy></picture></a></figure></p><p>確認される。</p><p>どうでもいい通知確認。「利用しない」でよい。</p><p><figure><a href=images/index/2023-01-27-02-15-09.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-15-09_hu6869259a5ba48d1b7283e8693ec0bf79_37118_500x500_fit_q80_h2_box_3.webp width=500 height=216><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-15-09_hu6869259a5ba48d1b7283e8693ec0bf79_37118_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=216 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-02-15-23.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-15-23_hu99e156f3db9392ad8c6b6877a16f29ab_36950_500x500_fit_q80_h2_box_3.webp width=500 height=190><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-15-23_hu99e156f3db9392ad8c6b6877a16f29ab_36950_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=190 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-02-16-34.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-16-34_hu24de01647632a89e4d2f74eb63fff05c_82226_500x500_fit_q80_h2_box_3.webp width=383 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-16-34_hu24de01647632a89e4d2f74eb63fff05c_82226_500x500_fit_q80_bgffffff_box_3.jpg width=383 height=500 loading=lazy></picture></a></figure></p><p>管理者アカウントを設定する模様。後で二段階認証を設定して封印するはずなので適当に。</p><p><figure><a href=images/index/2023-01-27-02-17-24.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-17-24_hu827157e4f9b4fcb45c0911ddeaa38f21_37365_500x500_fit_q80_h2_box_3.webp width=500 height=262><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-17-24_hu827157e4f9b4fcb45c0911ddeaa38f21_37365_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=262 loading=lazy></picture></a></figure></p><p>Cloud Identityアカウントが作成された</p><p><figure><a href=images/index/2023-01-27-02-21-35.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-21-35_huf72c36b0377bc9ebf38f071e15ef2102_75712_500x500_fit_q80_h2_box_3.webp width=500 height=461><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-21-35_huf72c36b0377bc9ebf38f071e15ef2102_75712_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=461 loading=lazy></picture></a></figure></p><p>そのまま作業を続行する。</p><h4 id=１ドメインを保護する>１．ドメインを保護する</h4><p><figure><a href=images/index/2023-01-27-02-22-34.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-22-34_hue6e038b3432d4e024167c3c979129d0e_43765_500x500_fit_q80_h2_box_3.webp width=500 height=257><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-22-34_hue6e038b3432d4e024167c3c979129d0e_43765_500x500_fit_q80_bgffffff_box_3.jpg alt="Cloud Identityの設定" width=500 height=257 loading=lazy></picture></a><figcaption>Cloud Identityの設定</figcaption></figure></p><p>「１．ドメインを保護する」から始める。保護を押す。</p><p><figure><a href=images/index/2023-01-27-02-23-39.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-23-39_huc83d32f7f5c7ade3f80e471bdd8402f8_129880_500x500_fit_q80_h2_box_3.webp width=500 height=345><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-23-39_huc83d32f7f5c7ade3f80e471bdd8402f8_129880_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=345 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-02-24-21.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-24-21_hud7a0761db666f1d25c82961d3158ae19_162884_500x500_fit_q80_h2_box_3.webp width=500 height=472><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-24-21_hud7a0761db666f1d25c82961d3158ae19_162884_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=472 loading=lazy></picture></a></figure></p><p>登録事業者というのは、ドメインを取ったところ（ドメインレジストラ）とか、ドメインを管理しているところを指す。
私はGoogle Domainsで.devドメインを取っているが、Azure DNSに委任しているので、Azure DNS側に設定することとなる。</p><p>手順2に移動する。</p><p><figure><a href=images/index/2023-01-27-02-31-36.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-31-36_hu6cb95f72dd047ee610b20ec16db202cb_198503_500x500_fit_q80_h2_box_3.webp width=401 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-31-36_hu6cb95f72dd047ee610b20ec16db202cb_198503_500x500_fit_q80_bgffffff_box_3.jpg width=401 height=500 loading=lazy></picture></a></figure></p><p>TXTレコードを設定しろと言われるので設定する。</p><p><figure><a href=images/index/2023-01-27-02-30-12.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-30-12_huf5cebbfc9aca0f47d3d0e616747fa5d8_28801_500x500_fit_q80_h2_box_3.webp width=500 height=453><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-30-12_huf5cebbfc9aca0f47d3d0e616747fa5d8_28801_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=453 loading=lazy></picture></a></figure></p><p>TTLは適当でよいが、コピペミスするとキャッシュが残ってしまい都合が悪いので5分とか短めが良いだろう。問い合わせる人はGoogleぐらいなのでTTLは短くてもWebに害はないだろう。</p><p>（でもこれ、ちんたらやってたら、適当なドメインのTXTをスキャンしまくっている悪い人に、TXTレコードにあるコードを盗み見ることができてしまい、自分のドメインのようにCloud Identityを設定できてしまわないか？Cloud Identityアカウントが被って弾かれるから大丈夫なのか？）</p><p>設定したら、手順2の画面に戻り「ドメインを保護」をクリック。</p><p><figure><a href=images/index/2023-01-27-02-36-53.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-36-53_hu286eba886fa0697f7a01dbbe259f9ce6_30094_500x500_fit_q80_h2_box_3.webp width=500 height=83><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-36-53_hu286eba886fa0697f7a01dbbe259f9ce6_30094_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=83 loading=lazy></picture></a></figure></p><p>完了した。</p><h4 id=2-新しいユーザを作成する>2. 新しいユーザを作成する</h4><p>チュートリアル的にユーザを作成してみる。</p><p>後述するGoogle cloud用の管理ユーザとして使う事を想定して「自分自身」を作ってみるとよいだろう。</p><p><figure><a href=images/index/2023-01-27-02-38-33.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-38-33_huc75d4065037ccd7f63407e37e6feda31_40215_500x500_fit_q80_h2_box_3.webp width=500 height=270><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-38-33_huc75d4065037ccd7f63407e37e6feda31_40215_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=270 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-02-43-04.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-43-04_hu5ca6d1a4f10da220511943252e6db677_60485_500x500_fit_q80_h2_box_3.webp width=500 height=237><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-43-04_hu5ca6d1a4f10da220511943252e6db677_60485_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=237 loading=lazy></picture></a></figure></p><p>一応予備のメールアドレスの重複が気になったので、エイリアスを払い出している。Microsoftアカウント(Outlookなど)を使っている場合、[https://account.live.com/AddAssocId] からエイリアスの作成が行えるはず。</p><p><figure><a href=images/index/2023-01-27-02-45-15.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-45-15_hud9760749d270e88a290552113edb6488_87357_500x500_fit_q80_h2_box_3.webp width=500 height=387><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-45-15_hud9760749d270e88a290552113edb6488_87357_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=387 loading=lazy></picture></a></figure></p><p>作成できた。</p><p><figure><a href=images/index/2023-01-27-02-46-16.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-46-16_huf02355aec2590838942444847403671b_46863_500x500_fit_q80_h2_box_3.webp width=500 height=131><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-46-16_huf02355aec2590838942444847403671b_46863_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=131 loading=lazy></picture></a></figure></p><p>一覧に戻ると追加されたことが確認できる。</p><h3 id=試しにメンバーのアカウントでログイン>試しにメンバーのアカウントでログイン</h3><p><figure><a href=images/index/2023-01-27-02-55-07.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-55-07_hu4c94003a3bc4dd88df9758d0106098c6_34274_500x500_fit_q80_h2_box_3.webp width=446 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-55-07_hu4c94003a3bc4dd88df9758d0106098c6_34274_500x500_fit_q80_bgffffff_box_3.jpg width=446 height=500 loading=lazy></picture></a></figure></p><p>Googleアカウントのようにログインできる。</p><p><figure><a href=images/index/2023-01-27-02-57-18.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-57-18_huac38d1155bdf990557231b673f90b3a2_16647_500x500_fit_q80_h2_box_3.webp width=500 height=74><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-57-18_huac38d1155bdf990557231b673f90b3a2_16647_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=74 loading=lazy></picture></a></figure></p><p>ためしにGmailにアクセスしてみたが使えない。それはそうか。</p><p><figure><a href=images/index/2023-01-27-02-58-34.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-58-34_hu118d22dcc8e3568dc677b7cd80a70632_93660_500x500_fit_q80_h2_box_3.webp width=425 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-02-58-34_hu118d22dcc8e3568dc677b7cd80a70632_93660_500x500_fit_q80_bgffffff_box_3.jpg width=425 height=500 loading=lazy></picture></a></figure></p><p>Google CloudのConsoleにはアクセスできた。有効化してないのもあるが、二段階認証は強制させたい。</p><h3 id=管理者ユーザでログインする>管理者ユーザでログインする</h3><p>作業を進めるためログインしなおす。（最初のGoogleアカウントではダメらしい？）</p><h3 id=２ユーザとグループ>２．ユーザとグループ</h3><p><figure><a href=images/index/2023-01-27-03-07-29.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-07-29_hu096b586a4c4e77b15dd20b0fe8afed6c_101683_500x500_fit_q80_h2_box_3.webp width=500 height=281><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-07-29_hu096b586a4c4e77b15dd20b0fe8afed6c_101683_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=281 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-03-08-04.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-08-04_huc3607bf07c984656ed82c4d21b59922a_241208_500x500_fit_q80_h2_box_3.webp width=494 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-08-04_huc3607bf07c984656ed82c4d21b59922a_241208_500x500_fit_q80_bgffffff_box_3.jpg alt=管理グループの作成画面 width=494 height=500 loading=lazy></picture></a><figcaption>管理グループの作成画面</figcaption></figure></p><p>管理グループは必要に応じて作る。「全てのグループを作成」でとりあえず作っておく。
正直細かすぎるように感じるが、合わないなと思ったら後で消したりすればよい。また、この時点で即座にロールが割り当たるわけではなく、それはこの後の作業で行われる。</p><p><figure><a href=images/index/2023-01-27-03-09-59.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-09-59_hu928057cfe75aeb183db3bab0a335f9bb_110778_500x500_fit_q80_h2_box_3.webp width=500 height=256><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-09-59_hu928057cfe75aeb183db3bab0a335f9bb_110778_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=256 loading=lazy></picture></a></figure></p><p>管理ユーザのためのユーザを作る。この作業自体はただのユーザ作成でこの後の管理グループに入れることで管理ユーザとなる。
例えば自身を含めると良いだろう。上記の手順の流れで作っている場合はそれを使えば良いので不要だし、他に作業を共にしている信頼できる人（上司やお客様のお偉い様など）を追加する。</p><p><figure><a href=images/index/2023-01-27-03-13-36.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-13-36_hu90c35816bf1f3d5e7a36fd7bc3346b1b_139818_500x500_fit_q80_h2_box_3.webp width=500 height=362><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-13-36_hu90c35816bf1f3d5e7a36fd7bc3346b1b_139818_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=362 loading=lazy></picture></a></figure></p><p>グループにユーザを追加していく。最初は最小限必要な人がよいがユースケースによって変わる。「組織」の規模でも違うため何とも言えない。</p><p>gcp-organization-adminsは強い権限なので、数人に留めておくとよいだろう。プロジェクトリーダー的な存在が居れば入れておくとよさそう。</p><p>gcp-developersは開発メンバー（インフラはあまり触らない人ら）を入れておいたりする。</p><p>今回はとりあえず全部に1人追加した。（gcp-organization-adminsが全てを兼ねるので全て入れる意味はない）</p><p><figure><a href=images/index/2023-01-27-03-18-50.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-18-50_hu119f30f7ce36f36e9fd385285e8e5ba3_228197_500x500_fit_q80_h2_box_3.webp width=500 height=472><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-18-50_hu119f30f7ce36f36e9fd385285e8e5ba3_228197_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=472 loading=lazy></picture></a></figure></p><p>メンバーはグループ作成者と追加作業したメンバーの2人になっている。作業に応じて変わる。</p><h3 id=３管理者権限>３．管理者権限</h3><p>（２）で作ったグループにロールを割り当てて権限を与えていく。</p><p><figure><a href=images/index/2023-01-27-03-27-43.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-27-43_hu44358ada627e4c576c64e92fbe6e4582_195139_500x500_fit_q80_h2_box_3.webp width=470 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-27-43_hu44358ada627e4c576c64e92fbe6e4582_195139_500x500_fit_q80_bgffffff_box_3.jpg alt=組織管理者権限を設定する width=470 height=500 loading=lazy></picture></a><figcaption>組織管理者権限を設定する</figcaption></figure></p><p><figure><a href=images/index/2023-01-27-03-28-55.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-28-55_hu74f96a98594fbab720b0b39bf5a64f9c_179328_500x500_fit_q80_h2_box_3.webp width=240 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-28-55_hu74f96a98594fbab720b0b39bf5a64f9c_179328_500x500_fit_q80_bgffffff_box_3.jpg width=240 height=500 loading=lazy></picture></a></figure></p><p>ここは手順に従ってやっていくだけ。</p><p>ただ、正しいグループ名でもエラーになった。この場合はページを開きなおしたりして作業をやりなおすと上手くいくかもしれない。</p><h3 id=４お支払い>４．お支払い</h3><p>「請求先アカウント」を作る作業。</p><p><figure><a href=images/index/2023-01-27-03-37-20.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-37-20_huccd1fd23e009cbd3bb455835313f45a2_87521_500x500_fit_q80_h2_box_3.webp width=500 height=209><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-37-20_huccd1fd23e009cbd3bb455835313f45a2_87521_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=209 loading=lazy></picture></a></figure></p><p>クレジットカードを使いたいので左を選ぶ。無料トライアル用のアカウントを作るだけなので請求は発生しないらしい。実際はどういう請求が良いかはニーズで選ぼう。</p><p><figure><a href=images/index/2023-01-27-03-51-26.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-51-26_huc7d5efde96bce46a27a9e4938fb12f92_91089_500x500_fit_q80_h2_box_3.webp width=500 height=426><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-51-26_huc7d5efde96bce46a27a9e4938fb12f92_91089_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=426 loading=lazy></picture></a></figure></p><p>別画面で請求先アカウントを作ると確定できる。</p><h3 id=５リソース階層とアクセスの設定>５．リソース階層とアクセスの設定</h3><p>ダレてきた。</p><p>５～７までは一通り設定した後、「デプロイまたはダウンロード」からTerraformファイル(tar.gz)のダウンロードかデプロイするか選んで行う。</p><p>今回はここでプロジェクトの割り当て増加のリクエストを行い、何もしない。</p><p><figure><a href=images/index/2023-01-27-03-38-49.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-38-49_huf74297079fee747b605e7d43390d7b2d_238892_500x500_fit_q80_h2_box_3.webp width=500 height=448><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-38-49_huf74297079fee747b605e7d43390d7b2d_238892_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=448 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-03-53-22.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-53-22_hu674626e3cf29a18585175c2eb4bb8e4a_133010_500x500_fit_q80_h2_box_3.webp width=500 height=311><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-53-22_hu674626e3cf29a18585175c2eb4bb8e4a_133010_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=311 loading=lazy></picture></a></figure></p><p>プロジェクトをいくつか作っていくのが流儀らしく、プロジェクト数の上限の制限（クォータ）に引っかかる可能性がある。デフォルトは５だったかな？
なので、「割り当て増加のリクエスト」を行う。</p><p><figure><a href=images/index/2023-01-27-03-56-10.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-56-10_hu3c0da453b326e9e9bd9d70e5305ec120_170607_500x500_fit_q80_h2_box_3.webp width=359 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-56-10_hu3c0da453b326e9e9bd9d70e5305ec120_170607_500x500_fit_q80_bgffffff_box_3.jpg width=359 height=500 loading=lazy></picture></a></figure></p><p>申請したら階層構造に応じたプロジェクトが作れるが、今回は何もしない。</p><p><figure><a href=images/index/2023-01-27-03-59-06.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-59-06_hu7e9beec69741878948079492b3d0f3ce_143293_500x500_fit_q80_h2_box_3.webp width=500 height=453><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-03-59-06_hu7e9beec69741878948079492b3d0f3ce_143293_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=453 loading=lazy></picture></a></figure></p><h3 id=６ネットワーキング>６．ネットワーキング</h3><p>今回は何もしない。</p><h3 id=７ロギングの一元化>７．ロギングの一元化</h3><p><figure><a href=images/index/2023-01-27-04-01-27.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-01-27_hu86cd9c8c34f71250e0784e70569b189c_162343_500x500_fit_q80_h2_box_3.webp width=500 height=429><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-01-27_hu86cd9c8c34f71250e0784e70569b189c_162343_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=429 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-04-02-20.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-02-20_hu545761c83e441e474bcd22567cb2c478_235752_500x500_fit_q80_h2_box_3.webp width=496 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-02-20_hu545761c83e441e474bcd22567cb2c478_235752_500x500_fit_q80_bgffffff_box_3.jpg width=496 height=500 loading=lazy></picture></a></figure></p><p>（４）で請求先アカウントを作っておかないと設定できなかった。</p><p><figure><a href=images/index/2023-01-27-04-03-25.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-03-25_hu04c792cfa57b22e27a865ddeea29a507_77065_500x500_fit_q80_h2_box_3.webp width=500 height=260><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-03-25_hu04c792cfa57b22e27a865ddeea29a507_77065_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=260 loading=lazy></picture></a></figure></p><h3 id=８モニタリング>８．モニタリング</h3><p>作業内容がなさそうだった。</p><h3 id=９セキュリティ>９．セキュリティ</h3><p><figure><a href=images/index/2023-01-27-04-07-35.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-07-35_hu89c48a3ba8b5c4f912defc883780386d_196642_500x500_fit_q80_h2_box_3.webp width=482 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-07-35_hu89c48a3ba8b5c4f912defc883780386d_196642_500x500_fit_q80_bgffffff_box_3.jpg width=482 height=500 loading=lazy></picture></a></figure></p><p>Cloud Security Command Center を開く。</p><p><figure><a href=images/index/2023-01-27-04-08-52.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-08-52_hu1fbd7df4b0e7db3441cf23a223164605_222794_500x500_fit_q80_h2_box_3.webp width=500 height=279><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-08-52_hu1fbd7df4b0e7db3441cf23a223164605_222794_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=279 loading=lazy></picture></a></figure></p><p>プランが表示される。とりあえず無料がいいですね。</p><p><figure><a href=images/index/2023-01-27-04-10-26.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-10-26_hu4cb9a46762acf4ae9b273af29e7cb63a_274753_500x500_fit_q80_h2_box_3.webp width=500 height=499><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-10-26_hu4cb9a46762acf4ae9b273af29e7cb63a_274753_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=499 loading=lazy></picture></a></figure></p><p>プレミアムとあるものは無効化しておく。</p><p><figure><a href=images/index/2023-01-27-04-10-52.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-10-52_huf0a191d6c5983ac410fb1bd4d64e5035_89534_500x500_fit_q80_h2_box_3.webp width=500 height=206><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-10-52_huf0a191d6c5983ac410fb1bd4d64e5035_89534_500x500_fit_q80_bgffffff_box_3.jpg width=500 height=206 loading=lazy></picture></a></figure></p><p><figure><a href=images/index/2023-01-27-04-11-39.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-11-39_hue22cd7b0c0cfce668a3ed1a449b78172_92304_500x500_fit_q80_h2_box_3.webp width=500 height=227><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-11-39_hue22cd7b0c0cfce668a3ed1a449b78172_92304_500x500_fit_q80_bgffffff_box_3.jpg alt=ロールが付与された width=500 height=227 loading=lazy></picture></a><figcaption>ロールが付与された</figcaption></figure></p><p><figure><a href=images/index/2023-01-27-04-13-08.png target=_blank onclick=showOverlay(event)><picture><source type=image/webp srcset=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-13-08_hu294c56e12e92255d61cfb8b3b7616dbd_103137_500x500_fit_q80_h2_box_3.webp width=475 height=500><img src=/posts/2023/01/27/google-cloud-identity/images/index/2023-01-27-04-13-08_hu294c56e12e92255d61cfb8b3b7616dbd_103137_500x500_fit_q80_bgffffff_box_3.jpg width=475 height=500 loading=lazy></picture></a></figure></p><p>組織のポリシーの設定は <a href=https://console.cloud.google.com/iam-admin/orgpolicies/list>組織のポリシーのリスト</a> で設定していく。
ここでは特に何もしない。</p><h3 id=１０サポート>１０．サポート</h3><p>よくあるサポートのプランを変えませんか、という話。</p><p>[https://console.cloud.google.com/support/offerings] から変更できる。デフォルトは無料のベーシックサポート。</p><p>無料が良いのでこのままにする。</p><p>一通りやってみたがわからないことだらけ。今日はここまで。</p><footer><p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 01-2.83.0L2 12V2h10l8.59 8.59a2 2 0 010 2.82z"/><line x1="7" y1="7" x2="7" y2="7"/></svg><span class=tag><a href=https://fukasawah.github.io/tags/google-cloud>#Google Cloud</a></span>
<span class=tag><a href=https://fukasawah.github.io/tags/google-cloud-identity>#Google Cloud Identity</a></span></p><p>Created at: 2023-01-27 05:20 +0900<br>Updated at: 2023-01-27 05:20 +0900 <a href=https://github.com/fukasawah/blog/commit/709acaca81dfeb0064c36dae6ad8ac719dd9537f target=_blank rel=noopener>#709acac</a></p><p><a href=https://fukasawah.github.io/posts/2023/01/27/google-cloud-identity-2sv/><span title="Google Cloud Identity で2段階認証を強制する">&lt; Next</span></a>
|
<a href=https://fukasawah.github.io/posts/><span title=Posts>Posts</span></a>
|
<a href=https://fukasawah.github.io/posts/2022/12/21/debug-ios-safari-on-windows/><span title="iOS SafariをWindows上からデバッグする">Prev ></span></a></p></footer></article><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//fukasawah.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
<script src=https://fukasawah.github.io/js/theme-posts.min.526bf4c8dff80bed936c62a06f7bc8c02703fad621e3dd2ba243812d43c40b98397ff1951e5905c790b97c38633d42a0e35bf5314fdf9fcfbce31b18181b8ae3.js integrity="sha512-Umv0yN/4C+2TbGKgb3vIwCcD+tYh490rokOBLUPEC5g5f/GVHlkFx5C5fDhjPUKg41v1MU/fn8+84xsYGBuK4w==" defer></script></main><footer><p>&copy; 2023 <a href=https://fukasawah.github.io/>fukasawah</a></p></footer></body></html>